<!DOCTYPE html>
<html lang="en"><head>

<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-FWJK9XZLFC"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-FWJK9XZLFC');
</script>
  
<!-- Google tag (gtag.js) -->

  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1"><!-- Begin Jekyll SEO tag v2.8.0 -->
<title>linux on mac | otávio mk</title>
<meta name="generator" content="Jekyll v4.4.1" />
<meta property="og:title" content="linux on mac" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="otávio manzano kavakama - cello" />
<meta property="og:description" content="otávio manzano kavakama - cello" />
<link rel="canonical" href="https://otaviomk.com/mac_linux/" />
<meta property="og:url" content="https://otaviomk.com/mac_linux/" />
<meta property="og:site_name" content="otávio mk" />
<meta property="og:type" content="website" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="linux on mac" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"WebPage","description":"otávio manzano kavakama - cello","headline":"linux on mac","url":"https://otaviomk.com/mac_linux/"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/assets/main.css">
  <link rel="shortcut icon" type="image/png" href="/favicon.png"/><link type="application/atom+xml" rel="alternate" href="https://otaviomk.com/feed.xml" title="otávio mk" /></head>
<body><header class="site-header" role="banner">

  <div class="wrapper"><a style="color:#fca311" class="site-title" rel="author" href="/">otávio mk</a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger"><a class="page-link" href="/about/">about</a><a class="page-link" href="/media/">media</a><a class="page-link" href="/works/">works</a><a class="page-link" href="/contact/">contact</a><a class='page-link page-link-flag' href="">
                    <img src="/assets/flag_br.jpg" style="height: 20px; border-radius: 50%;"></a>
        </div>
      </nav></div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post">

  <header class="post-header">
    <h1 class="post-title">linux on mac</h1>
  </header>

  <div class="post-content">
    <h2 id="if-you-got-here-from-google-or-the-like-please-be-aware-that-this-is-for-my-own-use-and-many-things-in-here-could-be-out-of-date-or-not-work-at-all">If you got here from google or the like, please be aware that this is for my own use, and many things in here could be out of date or not work at all.</h2>

<!-- vim-markdown-toc Redcarpet -->

<ul>
  <li><a href="#linux-on-mac">LINUX ON MAC</a>
    <ul>
      <li><a href="#fix-wake-up">Fix wake up</a></li>
      <li><a href="#fix-slow-wake-up-macbook-lid-open">Fix slow wake up (Macbook lid open)</a></li>
      <li><a href="#mbp-fan">MBP Fan</a></li>
      <li><a href="#how-to-install-ardour">How to install Ardour</a></li>
      <li><a href="#i3-backlight">I3 Backlight</a></li>
      <li><a href="#switch-keyboard-layout">Switch keyboard layout</a></li>
      <li><a href="#switch-keyboard-layout-i3">Switch keyboard layout i3</a></li>
      <li><a href="#xrandr">Xrandr</a></li>
      <li><a href="#obs-virtual-cam">OBS Virtual Cam</a></li>
      <li><a href="#problem-with-wifi">Problem with WiFi</a></li>
    </ul>
  </li>
</ul>

<!-- vim-markdown-toc -->

<h1 id="linux-on-mac">LINUX ON MAC</h1>

<hr />

<p>Always run this before doing anything: <code class="language-plaintext highlighter-rouge">sudo pacman -Syu</code></p>

<hr />

<h2 id="fix-wake-up">Fix wake up</h2>

<ul>
  <li>Check which elements wake up laptop
    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>cat /proc/acpi/wakeup
</code></pre></div>    </div>
  </li>
  <li>Check which elements are waking up laptop by disabling it and testing
    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>echo EHC1 &gt;&gt; /proc/acpi/wakeup
echo XXXX &gt;&gt; /proc/acpi/wakeup
</code></pre></div>    </div>
  </li>
  <li>Create file .service in /etc/systemd/system/, you can name it whatever
    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>nvim /etc/systemd/system/fixwakeup.service
</code></pre></div>    </div>
  </li>
  <li>Add this content:</li>
</ul>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>[Unit]
Description=fixwakeup

[Service]
ExecStart=/bin/bash -c "echo RP01 &gt;&gt; /proc/acpi/wakeup; echo RP02 &gt;&gt; /proc/acpi/wakeup; echo RP03 &gt;&gt; /proc/acpi/wakeup; echo EHC1 &gt;&gt; /proc/acpi/wakeup; echo EHC2 &gt;&gt; /proc/acpi/wakeup; echo XHC1 &gt;&gt; /proc/acpi/wakeup"

[Install]
WantedBy=multi-user.target
</code></pre></div></div>

<ul>
  <li>Run these commands:
    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>sudo systemctl daemon-reload
sudo systemctl start fixwakeup
</code></pre></div>    </div>
  </li>
  <li>Check status:</li>
</ul>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>systemctl status fixwakeup
</code></pre></div></div>

<ul>
  <li>Make it starts after boot:
    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>sudo systemctl enable fixwakeup
</code></pre></div>    </div>
  </li>
  <li>Reboot and check again with
    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>cat /proc/acpi/wakeup 
</code></pre></div>    </div>
  </li>
  <li>If need to know which code means what, if a code has a pci number, check that number with the output of <code class="language-plaintext highlighter-rouge">lspci</code></li>
</ul>

<p><a href="#top">Back to the top</a></p>

<hr />

<h2 id="fix-slow-wake-up-macbook-lid-open">Fix slow wake up (Macbook lid open)</h2>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>nvim /etc/systemd/logind.conf
</code></pre></div></div>

<ul>
  <li>Add these lines:</li>
</ul>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>HandlePowerKey=suspend
HandleLidSwitch=suspend
</code></pre></div></div>

<p><a href="#top">Back to the top</a></p>

<hr />

<h2 id="mbp-fan">MBP Fan</h2>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>sudo nvim /etc/modules
</code></pre></div></div>

<ul>
  <li>Add these lines:</li>
</ul>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>coretemp
applesmc
</code></pre></div></div>

<ul>
  <li>Install mbpfan-git through your AUR enabled package manager (paman, octopi with yay, etc)</li>
</ul>

<p>Run:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>sudo sensors-detect
sudo systemctl enable mbpfan
sudo systemctl start mbpfan
</code></pre></div></div>

<ul>
  <li>Configure mbpfan (optional)
    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>sudo nvim /etc/mbpfan.conf
</code></pre></div>    </div>
    <p>Suggestion:</p>
  </li>
</ul>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>min_fan1_speed = 1300
max_fan1_speed = 6100
low_temp = 60  
high_temp = 64  
max_temp = 80  
polling_interval = 3
</code></pre></div></div>

<p><a href="#top">Back to the top</a></p>

<hr />

<h2 id="how-to-install-ardour">How to install Ardour</h2>

<ul>
  <li>
    <p>Install cadence</p>
  </li>
  <li>
    <p>Install jack2</p>
  </li>
  <li>
    <p>Install pulseaudio-jack (for PA jack bridge)</p>
  </li>
  <li>Run
    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>sudo nvim /etc/security/limits.conf
</code></pre></div>    </div>
  </li>
  <li>Add:</li>
</ul>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>@audio - rtprio 95
@audio - memlock unlimited
</code></pre></div></div>

<ul>
  <li>Go to
    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>sudo nvim /etc/security/limits.d/10-gcr.conf
</code></pre></div>    </div>
  </li>
  <li>Comment line
    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code># @user yada yada
</code></pre></div>    </div>
  </li>
  <li>Check if user is in audio group
    <ul>
      <li>In terminal:
        <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>groups
</code></pre></div>        </div>
      </li>
    </ul>
  </li>
  <li>If not:
    <ul>
      <li>Add audio group:
        <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>groupadd audio
</code></pre></div>        </div>
      </li>
      <li>Add user to audio group:
        <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>usermod -aG audio $USER
</code></pre></div>        </div>
      </li>
    </ul>
  </li>
</ul>

<p>REBOOT!!</p>

<p><a href="#top">Back to the top</a></p>

<hr />

<h2 id="i3-backlight">I3 Backlight</h2>

<ul>
  <li>
    <p>Install AUR package: macbook-lighter</p>
  </li>
  <li>Change privileges of folder:
    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>sudo chmod -c -v a+x+w /sys/class/backlight/intel_backlight/brightness
</code></pre></div>    </div>
  </li>
  <li>In i3 conf file, edit backlight (this is for usb keyboard without a backlight special key):</li>
</ul>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>bindsym control+F2 exec --no-startup-id macbook-lighter-screen --inc 100 # increase screen brightness
bindsym control+F1 exec --no-startup-id macbook-lighter-screen --dec 100 # decrease screen brightness
</code></pre></div></div>

<ul>
  <li>
    <p>To make macbook backlight key to work:</p>
  </li>
  <li>Install acpid</li>
  <li>Run:
    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>systemctl start acpi-service
systemctl enable acpi.service
</code></pre></div>    </div>
  </li>
  <li>Run to check key code:
    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>acpi_listen 
</code></pre></div>    </div>
  </li>
</ul>

<p>(then press the special keys, code is after description)</p>

<ul>
  <li>Run:
    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>sudo vim /etc/acpi/events/bl-down
</code></pre></div>    </div>
  </li>
  <li>Add:</li>
</ul>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>event=video/brightnessdown BRTDN 00000087 00000000
action=macbook-lighter-screen --dec 100

event=video/brightnessup BRTUP 00000086 00000000
action=macbook-lighter-screen --inc 100
</code></pre></div></div>

<ul>
  <li>Restart acpid:
    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>systemctl stop acpid.service
systemctl start acpid.service
</code></pre></div>    </div>
  </li>
</ul>

<p><a href="#top">Back to the top</a></p>

<hr />

<h2 id="switch-keyboard-layout">Switch keyboard layout</h2>

<ul>
  <li>Add to this file:
    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>/etc/X11/xorg.conf.d/00-keyboard.conf
</code></pre></div>    </div>
  </li>
  <li>This:
    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Option "XkbLayout" "br,us"
Option "XkbOptions" "grp:alt_shift_toggle"
EndSection
</code></pre></div>    </div>
  </li>
</ul>

<p><a href="#top">Back to the top</a></p>

<hr />

<h2 id="switch-keyboard-layout-i3">Switch keyboard layout i3</h2>

<ul>
  <li>Follow steps above to add “br” to xorg file</li>
  <li>Create script i3-keyboard-layout at ~/.config/i3/scripts/</li>
  <li>Make executable:
    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>chmod +x &lt;script&gt;
</code></pre></div>    </div>
  </li>
  <li>Add to i3 config file:</li>
</ul>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>bindsym $mod+z exec path/to/i3-keyboard-layout set us
bindsym $mod+x exec path/to/i3-keyboard-layout set br
bindsym $mod+space exec path/to/i3-keyboard-layout cycle us br
</code></pre></div></div>

<p><a href="#top">Back to the top</a></p>

<hr />

<h2 id="xrandr">Xrandr</h2>

<p><code class="language-plaintext highlighter-rouge">xrandr --output LVDS1 --primary --mode 1280x800 --rate 144.00 --output HDMI1 --mode 1920x1080 --rate 60.00 --right-of LVDS1</code></p>

<hr />

<h2 id="obs-virtual-cam">OBS Virtual Cam</h2>

<ul>
  <li>
    <p>Install https://github.com/umlaeute/v4l2loopback</p>
  </li>
  <li>git clone ……</li>
  <li>cd to folder</li>
  <li>
    <p>make &amp;&amp; sudo make install</p>
  </li>
  <li>Install https://github.com/CatxFish/obs-v4l2sink
    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>yay -Syu obs-v4l2sink
</code></pre></div>    </div>
  </li>
  <li>Load module
    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>sudo modprobe v4l2loopback
</code></pre></div>    </div>
  </li>
  <li>In OBS
    <ul>
      <li>Tools &gt; v4l2</li>
      <li>Select video device (here /dev/video2)</li>
      <li>Start</li>
    </ul>
  </li>
  <li>Run to the hug</li>
</ul>

<p><a href="#top">Back to the top</a></p>

<hr />

<h2 id="problem-with-wifi">Problem with WiFi</h2>

<p>Read the info about BCM4331 on the Arch Wiki</p>

<p>Install linux-header, linux-lts-header and other stuff</p>


  </div>

</article>

      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/"></data>

  <div class="wrapper">

    <!-- <h2 class="footer-heading">otávio mk</h2> -->

    <!-- <div class="footer-col-wrapper"> -->
      <!-- <div class="footer-col footer-col-1"> -->
      <!--   <ul class="contact-list"> -->
      <!--     <!-1- <li class="p-name"> -1-> -->
      <!--     <!-1--1-> -->
      <!--     <!-1-     otávio mk -1-> -->
      <!--     <!-1--1-> -->
      <!--     <!-1-   </li> -1-> -->
      <!--       <!-1--1-> -->
      <!--   </ul> -->
      <!-- </div> -->

      <!-- <div class="footer-col footer-col-2"> -->
      <div><ul class="social-media-list">
  <!-- <li style="display:inline"><a target="_blank" href="https://www.youtube.com/channel/UCFSm9mZHqqNlxPxyEDmPjQA"><svg class="svg-icon"><use xlink:href="/assets/minima-social-icons.svg#youtube"></use></svg> <span class="username"></span></a></li> --><li style="display:inline"><a target="_blank" href="https://www.youtube.com/channel/UCFSm9mZHqqNlxPxyEDmPjQA">youtube</a></li>
<li style="display:inline"><a target="_blank" href="https://kavotaman.bandcamp.com">bandcamp</a></li>
<li style="display:inline"><a target="_blank" href="https://ruidospodcast.com.br">ruidospodcast</a></li>
<li style="display:inline"><a target="_blank" href="https://github.com/kavotaman">github</a></li>
</ul>
</div>

      <!-- <div class="footer-col footer-col-3"> -->
      <!--   <p>otávio manzano kavakama - cello</p> -->
      <!-- </div> -->
    <!-- </div> -->

  </div>

</footer>
</body>

</html>
